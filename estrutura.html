<html>
  <head>
    <meta charset="utf-8">
    <title>Aula de JS</title>
	<script>
		//https://xanadu1010.wordpress.com/2013/03/09/usando-javascript-para-pegar-valores-enviados-a-pagina-html-via-get/
		function _GET(name)
		{
		  var url   = window.location.search.replace("?", "");
		  var itens = url.split("&");

		  for(n in itens)
		  {
		    if( itens[n].match(name) )
		    {
		      return decodeURIComponent(itens[n].replace(name+"=", ""));
		    }
		  }
		  return null;
		}

		//http://stackoverflow.com/questions/2450954/how-to-randomize-shuffle-a-javascript-array
		function shuffle(array) {
			var currentIndex = array.length, temporaryValue, randomIndex;
			// While there remain elements to shuffle...
			while (0 !== currentIndex) {
				// Pick a remaining element...
				randomIndex = Math.floor(Math.random() * currentIndex);
				currentIndex -= 1;
				// And swap it with the current element.
				temporaryValue = array[currentIndex];
				array[currentIndex] = array[randomIndex];
				array[randomIndex] = temporaryValue;
			}
			return array;
		}
		
		function atualizaNomes() {
			document.getElementById("nomeP1").innerHTML = nomePlayer1;
			document.getElementById("nomeP2").innerHTML = nomePlayer2;
		}

		function atualizaPlacar() {
			document.getElementById("placarP1").innerHTML = acertosP1.toString();
			document.getElementById("placarP2").innerHTML = acertosP2.toString();
		}

		function atualizaVezDeJogador() {
			if(vezPlayer1) {
				document.getElementById("nomeP1").style.color = "#FF0000";
				document.getElementById("placarP1").style.color = "#FF0000";
				document.getElementById("nomeP2").style.color = "#000000";
				document.getElementById("placarP2").style.color = "#000000";
			} else {
				document.getElementById("nomeP2").style.color = "#FF0000";
				document.getElementById("placarP2").style.color = "#FF0000";
				document.getElementById("nomeP1").style.color = "#000000";
				document.getElementById("placarP1").style.color = "#000000";
			}
		}

		function getArrayImagens() {
			var array = ["img/q01.jpg", "img/r01.jpg",
						 "img/q02.jpg", "img/r02.jpg",
						 "img/q03.jpg", "img/r03.jpg",
						 "img/q04.jpg", "img/r04.jpg", 
						 "img/q05.jpg", "img/r05.jpg",
						 "img/q06.jpg", "img/r06.jpg",
						 "img/q07.jpg", "img/r07.jpg",
						 "img/q08.jpg", "img/r08.jpg",
						 "img/q09.jpg", "img/r09.jpg",
						 "img/q10.jpg", "img/r10.jpg",
						 "img/q11.jpg", "img/r11.jpg",
						 "img/q12.jpg", "img/r12.jpg",
						 "img/q13.jpg", "img/r13.jpg",
						 "img/q14.jpg", "img/r14.jpg",
						 "img/q15.jpg", "img/r15.jpg",
						 "img/q16.jpg", "img/r16.jpg",
						 "img/q17.jpg", "img/r17.jpg",
						 "img/q18.jpg", "img/r18.jpg"];
			return shuffle(array);
		}

		function checkFimDeJogo() {
			if(acertosP1 + acertosP2 === 18) {

			}
		}

		function acerto(posicao1, posicao2) {
			var nome1 = "but" + posicao1;
			var nome2 = "but" + posicao2;
			document.getElementById(nome1).disabled = "disabled";
			document.getElementById(nome2).disabled = "disabled";
			if(vezPlayer1) {
				acertosP1++;
			} else {
				acertosP2++;
			}
			atualizaPlacar();
			checkFimDeJogo();
		}

		function responder(posicao1, posicao2) {
			var imagem1 = arrayImagens[posicao1];
			var imagem2 = arrayImagens[posicao2];
			if(imagem1.charAt(4) !== imagem2.charAt(4)) {
				var numero1 = imagem1.substring(5, 7);
				var numero2 = imagem2.substring(5, 7);
				if(numero1 === numero2) {
					acerto(posicao1, posicao2);
					return true;
				}
			}
			var nome1 = "img" + posicao1;
			var nome2 = "img" + posicao2;
			document.getElementById(nome1).src = "img/oculto.jpg";
			document.getElementById(nome2).src = "img/oculto.jpg";
			vezPlayer1 = !vezPlayer1;
			atualizaVezDeJogador();
			return false;
		}

		function clique(posicao) {
			qtdCliques++;
			var nome = "img" + posicao;
			document.getElementById(nome).src = arrayImagens[posicao];
			if(qtdCliques % 2 === 0) {
				//http://www.pinceladasdaweb.com.br/blog/2009/09/01/os-temporizadores-do-javascript/
				setTimeout(function () {
					responder(aberto, posicao);
				}, 2000);
			} else {
				aberto = posicao;
			}
		}
		
		function prepare() {
			arrayImagens = getArrayImagens();
			nomePlayer1 = _GET("1player");
			nomePlayer2 = _GET("2player");
			vezPlayer1 = true;
			qtdCliques = 0;
			aberto = null;
			acertosP1 = 0;
			acertosP2 = 0;
			atualizaNomes();
			atualizaPlacar();
			atualizaVezDeJogador();
		}
		//http://tutsmais.com.br/blog/javascript-2/metodos-funcoes-javascript-number-array-string-regexp/#sumario
	</script>
  </head>
  <body onload="prepare()">
    <table>
		<tr>
			<td colspan=3><center><b><div id="nomeP1" style="display:inline;"></div>: <div id="placarP1" style="display:inline;"></div></b></center></td>
			<td colspan=3><center><b><div id="nomeP2" style="display:inline;"></div>: <div id="placarP2" style="display:inline;"></div></b></center></td>
		</tr>
		<tr>
			<td><button id="but0" type="button" onClick="clique(0)"><img id="img0" src="img/oculto.jpg" width=100px height=100px></button></td>
			<td><button id="but1" type="button" onClick="clique(1)"><img id="img1" src="img/oculto.jpg" width=100px height=100px></button></td>
			<td><button id="but2" type="button" onClick="clique(2)"><img id="img2" src="img/oculto.jpg" width=100px height=100px></button></td>
			<td><button id="but3" type="button" onClick="clique(3)"><img id="img3" src="img/oculto.jpg" width=100px height=100px></button></td>
			<td><button id="but4" type="button" onClick="clique(4)"><img id="img4" src="img/oculto.jpg" width=100px height=100px></button></td>
			<td><button id="but5" type="button" onClick="clique(5)"><img id="img5" src="img/oculto.jpg" width=100px height=100px></button></td>
		</tr>
		<tr>
			<td><button id="but6" type="button" onClick="clique(6)"><img id="img6" src="img/oculto.jpg" width=100px height=100px></button></td>
			<td><button id="but7" type="button" onClick="clique(7)"><img id="img7" src="img/oculto.jpg" width=100px height=100px></button></td>
			<td><button id="but8" type="button" onClick="clique(8)"><img id="img8" src="img/oculto.jpg" width=100px height=100px></button></td>
			<td><button id="but9" type="button" onClick="clique(9)"><img id="img9" src="img/oculto.jpg" width=100px height=100px></button></td>
			<td><button id="but10" type="button" onClick="clique(10)"><img id="img10" src="img/oculto.jpg" width=100px height=100px></button></td>
			<td><button id="but11" type="button" onClick="clique(11)"><img id="img11" src="img/oculto.jpg" width=100px height=100px></button></td>
		</tr>
		<tr>
			<td><button id="but12" type="button" onClick="clique(12)"><img id="img12" src="img/oculto.jpg" width=100px height=100px></button></td>
			<td><button id="but13" type="button" onClick="clique(13)"><img id="img13" src="img/oculto.jpg" width=100px height=100px></button></td>
			<td><button id="but14" type="button" onClick="clique(14)"><img id="img14" src="img/oculto.jpg" width=100px height=100px></button></td>
			<td><button id="but15" type="button" onClick="clique(15)"><img id="img15" src="img/oculto.jpg" width=100px height=100px></button></td>
			<td><button id="but16" type="button" onClick="clique(16)"><img id="img16" src="img/oculto.jpg" width=100px height=100px></button></td>
			<td><button id="but17" type="button" onClick="clique(17)"><img id="img17" src="img/oculto.jpg" width=100px height=100px></button></td>
		</tr>
		<tr>
			<td><button id="but18" type="button" onClick="clique(18)"><img id="img18" src="img/oculto.jpg" width=100px height=100px></button></td>
			<td><button id="but19" type="button" onClick="clique(19)"><img id="img19" src="img/oculto.jpg" width=100px height=100px></button></td>
			<td><button id="but20" type="button" onClick="clique(20)"><img id="img20" src="img/oculto.jpg" width=100px height=100px></button></td>
			<td><button id="but21" type="button" onClick="clique(21)"><img id="img21" src="img/oculto.jpg" width=100px height=100px></button></td>
			<td><button id="but22" type="button" onClick="clique(22)"><img id="img22" src="img/oculto.jpg" width=100px height=100px></button></td>
			<td><button id="but23" type="button" onClick="clique(23)"><img id="img23" src="img/oculto.jpg" width=100px height=100px></button></td>
		</tr>
		<tr>
			<td><button id="but24" type="button" onClick="clique(24)"><img id="img24" src="img/oculto.jpg" width=100px height=100px></button></td>
			<td><button id="but25" type="button" onClick="clique(25)"><img id="img25" src="img/oculto.jpg" width=100px height=100px></button></td>
			<td><button id="but26" type="button" onClick="clique(26)"><img id="img26" src="img/oculto.jpg" width=100px height=100px></button></td>
			<td><button id="but27" type="button" onClick="clique(27)"><img id="img27" src="img/oculto.jpg" width=100px height=100px></button></td>
			<td><button id="but28" type="button" onClick="clique(28)"><img id="img28" src="img/oculto.jpg" width=100px height=100px></button></td>
			<td><button id="but29" type="button" onClick="clique(29)"><img id="img29" src="img/oculto.jpg" width=100px height=100px></button></td>
		</tr>
		<tr>
			<td><button id="but30" type="button" onClick="clique(30)"><img id="img30" src="img/oculto.jpg" width=100px height=100px></button></td>
			<td><button id="but31" type="button" onClick="clique(31)"><img id="img31" src="img/oculto.jpg" width=100px height=100px></button></td>
			<td><button id="but32" type="button" onClick="clique(32)"><img id="img32" src="img/oculto.jpg" width=100px height=100px></button></td>
			<td><button id="but33" type="button" onClick="clique(33)"><img id="img33" src="img/oculto.jpg" width=100px height=100px></button></td>
			<td><button id="but34" type="button" onClick="clique(34)"><img id="img34" src="img/oculto.jpg" width=100px height=100px></button></td>
			<td><button id="but35" type="button" onClick="clique(35)"><img id="img35" src="img/oculto.jpg" width=100px height=100px></button></td>
		</tr>
	</table>
  </body>
</html>